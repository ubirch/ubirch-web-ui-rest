package com.ubirch.webui.batch

import org.scalatest.{FunSuite, Matchers}

class SIMTest extends FunSuite with Matchers {

  test("testExtractData") {
    val id = SIM.extractIdFromCert("MIIDFTCCAf2gAwIBAgIBATANBgkqhkiG9w0BAQ0FADAeMRwwGgYDVQQDDBN1YmlyY2ggR21iSCBUZXN0IENBMB4XDTIwMDIyNjIzMDExOVoXDTIxMDIyNjA5MTAyOVowfjEQMA4GA1UEBhMHR2VybWFueTEZMBcGA1UECgwQdWJpcmNoIFRlc3QgR21iSDEPMA0GA1UEBwwGQmVybGluMQ8wDQYDVQQIDAZCZXJsaW4xLTArBgNVBAMMJGVmN2QzMzU1LWFlNDQtNDM5Mi1iYjNiLWFjNjA1YTY0ZDk5NjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAI7EBXTzhJUTeHU/jCM3Xcg83lHzd8tdJPs0ysaI9vnHdj8IO7HFNpzdKfqVeG1VzoAJcjQ37Un7h0fxOpbsGrgUsQPGDPeJaUru34MQLnPhK9E59aP62WKOqE2RVubrGznvs9gcbUolzrd9+q58c87pDKbBm4JkdKcUKJfRG7rEtUAixd0IOKqKp18NNpaU5sZv+soo0LhjdDqiElMfbxE/mAUTl6nY5281bXuGf9JNFasSd3JgnTHD88EL0SX4B5Xn5bsQBatff+aqeu6il2wPQ38W1YOuZOfyqFyrUsQHAqnEde9PCkdwbMD9pcpn8baijY6lhNrOfHeFmmFzc10CAwEAATANBgkqhkiG9w0BAQ0FAAOCAQEAcb37mPrqX9n1XBwKcYvBgwAKhZon2MsEQsdVDYGYiQIVSpzfvGNdtTyV5iEbTaNcqKzuWVnXXgoDkX5wQR6DqI8YDBZF/Q6eRXcH2QaJX/9U1ij0kAPovQfd2dASRNNV+MNslX7KKqjYpvx2ja5fpZOemCbyUgVJupQZvg8zNHEnthLpb0eOjLrhuYzGr9URJQccavmI2bkIspz4ItW+sMKIM0BIwSjUPIcJ+G2YNtifoMaHA0YB8FYKDby2m39EUNrU7BoeMh2z4ssH5RjbNd3JBe8v0tQpEfDSFoXJ3hC9/CwQZ2LlamqCCce0jkp05CdL/DrEmOjptPYtnCmGow==")
    id match {
      case Right(uuid) =>
        assert(uuid == "ef7d3355-ae44-4392-bb3b-ac605a64d996")
      case Left(error) =>
        fail(error)
    }

  }

  test("invalid testExtractData") {
    val id = SIM.extractIdFromCert("MIIDTCCAf2gAwIBAgIBATANBgkqhkiG9w0BAQ0FADAeMRwwGgYDVQQDDBN1YmlyY2ggR21iSCBUZXN0IENBMB4XDTIwMDIyNjIzMDExOVoXDTIxMDIyNjA5MTAyOVowfjEQMA4GA1UEBhMHR2VybWFueTEZMBcGA1UECgwQdWJpcmNoIFRlc3QgR21iSDEPMA0GA1UEBwwGQmVybGluMQ8wDQYDVQQIDAZCZXJsaW4xLTArBgNVBAMMJGVmN2QzMzU1LWFlNDQtNDM5Mi1iYjNiLWFjNjA1YTY0ZDk5NjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAI7EBXTzhJUTeHU/jCM3Xcg83lHzd8tdJPs0ysaI9vnHdj8IO7HFNpzdKfqVeG1VzoAJcjQ37Un7h0fxOpbsGrgUsQPGDPeJaUru34MQLnPhK9E59aP62WKOqE2RVubrGznvs9gcbUolzrd9+q58c87pDKbBm4JkdKcUKJfRG7rEtUAixd0IOKqKp18NNpaU5sZv+soo0LhjdDqiElMfbxE/mAUTl6nY5281bXuGf9JNFasSd3JgnTHD88EL0SX4B5Xn5bsQBatff+aqeu6il2wPQ38W1YOuZOfyqFyrUsQHAqnEde9PCkdwbMD9pcpn8baijY6lhNrOfHeFmmFzc10CAwEAATANBgkqhkiG9w0BAQ0FAAOCAQEAcb37mPrqX9n1XBwKcYvBgwAKhZon2MsEQsdVDYGYiQIVSpzfvGNdtTyV5iEbTaNcqKzuWVnXXgoDkX5wQR6DqI8YDBZF/Q6eRXcH2QaJX/9U1ij0kAPovQfd2dASRNNV+MNslX7KKqjYpvx2ja5fpZOemCbyUgVJupQZvg8zNHEnthLpb0eOjLrhuYzGr9URJQccavmI2bkIspz4ItW+sMKIM0BIwSjUPIcJ+G2YNtifoMaHA0YB8FYKDby2m39EUNrU7BoeMh2z4ssH5RjbNd3JBe8v0tQpEfDSFoXJ3hC9/CwQZ2LlamqCCce0jkp05CdL/DrEmOjptPYtnCmGow==")
    id match {
      case Right(uuid) =>
        fail("error missing")
      case Left(error) =>
        assert(error == "got invalid cert string: MIIDTCCAf2gAwIBAgIBATANBgkqhkiG9w0BAQ0FADAeMRwwGgYDVQQDDBN1YmlyY2ggR21iSCBUZXN0IENBMB4XDTIwMDIyNjIzMDExOVoXDTIxMDIyNjA5MTAyOVowfjEQMA4GA1UEBhMHR2VybWFueTEZMBcGA1UECgwQdWJpcmNoIFRlc3QgR21iSDEPMA0GA1UEBwwGQmVybGluMQ8wDQYDVQQIDAZCZXJsaW4xLTArBgNVBAMMJGVmN2QzMzU1LWFlNDQtNDM5Mi1iYjNiLWFjNjA1YTY0ZDk5NjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAI7EBXTzhJUTeHU/jCM3Xcg83lHzd8tdJPs0ysaI9vnHdj8IO7HFNpzdKfqVeG1VzoAJcjQ37Un7h0fxOpbsGrgUsQPGDPeJaUru34MQLnPhK9E59aP62WKOqE2RVubrGznvs9gcbUolzrd9+q58c87pDKbBm4JkdKcUKJfRG7rEtUAixd0IOKqKp18NNpaU5sZv+soo0LhjdDqiElMfbxE/mAUTl6nY5281bXuGf9JNFasSd3JgnTHD88EL0SX4B5Xn5bsQBatff+aqeu6il2wPQ38W1YOuZOfyqFyrUsQHAqnEde9PCkdwbMD9pcpn8baijY6lhNrOfHeFmmFzc10CAwEAATANBgkqhkiG9w0BAQ0FAAOCAQEAcb37mPrqX9n1XBwKcYvBgwAKhZon2MsEQsdVDYGYiQIVSpzfvGNdtTyV5iEbTaNcqKzuWVnXXgoDkX5wQR6DqI8YDBZF/Q6eRXcH2QaJX/9U1ij0kAPovQfd2dASRNNV+MNslX7KKqjYpvx2ja5fpZOemCbyUgVJupQZvg8zNHEnthLpb0eOjLrhuYzGr9URJQccavmI2bkIspz4ItW+sMKIM0BIwSjUPIcJ+G2YNtifoMaHA0YB8FYKDby2m39EUNrU7BoeMh2z4ssH5RjbNd3JBe8v0tQpEfDSFoXJ3hC9/CwQZ2LlamqCCce0jkp05CdL/DrEmOjptPYtnCmGow==")
    }
  }

}
